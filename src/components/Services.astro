---
interface Props {
  services: string[];
}

const { services } = Astro.props as Props;

const isDesign = (value: string) =>
  value.includes('建築・土木設計監理') || value.includes('インテリアデザイン');

const isProduce = (value: string) =>
  value.includes('事業計画') ||
  value.includes('コンサルティング') ||
  value.includes('都市開発') ||
  value.includes('プロデュース') ||
  value.includes('ホテル');

const designItems = services.filter(isDesign);
const produceItems = services.filter((item) => !isDesign(item) && isProduce(item));
const techItems = services.filter((item) => !isDesign(item) && !isProduce(item));

const basePath = import.meta.env.BASE_URL.replace(/\/$/, '');
const toPublicPath = (path: string) => `${basePath}${path}`;

const categories = [
  {
    title: '設計・監理',
    subtitle: 'Architecture & Supervision',
    image: toPublicPath('/assets/services-architecture.jpg'),
    items: designItems,
  },
  {
    title: 'プロデュース',
    subtitle: 'Produce',
    image: toPublicPath('/assets/services-vision.jpg'),
    items: produceItems,
  },
  {
    title: 'テクノロジー',
    subtitle: 'Technology',
    image: toPublicPath('/assets/services-delivery.jpg'),
    items: techItems,
  },
];
---

<section id="services" class="section-space bg-surface-50">
  <div class="site-container">
    <p class="section-eyebrow">Services</p>
    <h2 class="section-title">サービス</h2>
    <p class="section-summary">
      設計・監理、事業プロデュース、テクノロジー開発を連携させ、構想から運用まで一貫して支援します。
    </p>

    <div class="mt-12 grid gap-6 lg:grid-cols-3">
      {categories.map((category) => (
        <article class="soft-card overflow-hidden">
          <img src={category.image} alt="" class="h-44 w-full object-cover" loading="lazy" />
          <div class="p-6">
            <p class="text-xs uppercase tracking-[0.14em] text-accent-600">{category.subtitle}</p>
            <h3 class="mt-2 text-3xl font-semibold text-surface-900">{category.title}</h3>
            <ul class="mt-5 space-y-2.5 text-sm text-surface-700">
              {category.items.map((item) => (
                <li class="flex items-start gap-2.5">
                  <span class="mt-2 h-1.5 w-1.5 rounded-full bg-accent-500"></span>
                  <span>{item}</span>
                </li>
              ))}
            </ul>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>
